module.exports=[93695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},50645,a=>{a.n(a.i(27572))},43619,a=>{a.n(a.i(79962))},13718,a=>{a.n(a.i(85523))},18198,a=>{a.n(a.i(45518))},62212,a=>{a.n(a.i(66114))},95110,a=>{a.n(a.i(62629))},94708,a=>{"use strict";a.s(["default",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/src/components/product-card.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/product-card.tsx <module evaluation>","default")},10117,a=>{"use strict";a.s(["default",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/src/components/product-card.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/product-card.tsx","default")},92787,a=>{"use strict";a.i(94708);var b=a.i(10117);a.n(b)},62115,a=>{"use strict";var b=a.i(93321),c=a.i(51674),d=a.i(30385),e=a.i(37137);async function f(a,g={}){let h,{flower:i,occasion:j,color:k,inStock:l,search:m,page:n=1,limit:o=12,sort:p="newest"}=g,q=[];q.push((0,b.eq)(e.products.isActive,!0)),i&&q.push((0,b.eq)(e.products.flowerType,i)),void 0!==l&&q.push((0,b.eq)(e.products.inStock,l)),m&&q.push((0,b.like)(e.products.name,`%${m}%`));let r=null;if(j){let c=await a.select({id:e.occasions.id}).from(e.occasions).where((0,b.eq)(e.occasions.slug,j)).get();r=c?(await a.select({productId:e.productOccasions.productId}).from(e.productOccasions).where((0,b.eq)(e.productOccasions.occasionId,c.id)).all()).map(a=>a.productId):[]}let s=null;if(k){let c=await a.select({id:e.colors.id}).from(e.colors).where((0,b.eq)(e.colors.slug,k)).get();s=c?(await a.select({productId:e.productColors.productId}).from(e.productColors).where((0,b.eq)(e.productColors.colorId,c.id)).all()).map(a=>a.productId):[]}if(null!==r&&null!==s){let a=r.filter(a=>s.includes(a));if(0===a.length)return{products:[],total:0};q.push((0,b.inArray)(e.products.id,a))}else if(null!==r){if(0===r.length)return{products:[],total:0};q.push((0,b.inArray)(e.products.id,r))}else if(null!==s){if(0===s.length)return{products:[],total:0};q.push((0,b.inArray)(e.products.id,s))}switch(p){case"price-asc":h=(0,d.asc)(e.products.price);break;case"price-desc":h=(0,d.desc)(e.products.price);break;case"rating":h=(0,d.desc)(e.products.averageRating);break;default:h=(0,d.desc)(e.products.createdAt)}let t=q.length>0?(0,b.and)(...q):void 0,u=await a.select({count:c.sql`count(*)`}).from(e.products).where(t).get(),v=u?.count??0;return{products:await a.select().from(e.products).where(t).orderBy(h).limit(o).offset((n-1)*o).all(),total:v,page:n,limit:o,totalPages:Math.ceil(v/o)}}a.s(["getProducts",()=>f])},18365,a=>{"use strict";a.s(["default",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/src/components/products/active-filter.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/products/active-filter.tsx <module evaluation>","default")},16737,a=>{"use strict";a.s(["default",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/src/components/products/active-filter.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/products/active-filter.tsx","default")},15407,a=>{"use strict";a.i(18365);var b=a.i(16737);a.n(b)},31562,a=>{"use strict";a.s(["default",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/src/components/products/product-list-sort.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/products/product-list-sort.tsx <module evaluation>","default")},15689,a=>{"use strict";a.s(["default",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/src/components/products/product-list-sort.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/products/product-list-sort.tsx","default")},87580,a=>{"use strict";a.i(31562);var b=a.i(15689);a.n(b)},80713,a=>{"use strict";a.s(["default",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/src/components/products/product-pagination.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/products/product-pagination.tsx <module evaluation>","default")},33647,a=>{"use strict";a.s(["default",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/src/components/products/product-pagination.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/products/product-pagination.tsx","default")},57702,a=>{"use strict";a.i(80713);var b=a.i(33647);a.n(b)},92778,a=>{"use strict";var b=a.i(7997),c=a.i(15407),d=a.i(92787),e=a.i(87580),f=a.i(57702);let g=a=>new Intl.NumberFormat("en-LK",{minimumFractionDigits:2,maximumFractionDigits:2}).format(a),h=(0,a.i(1269).default)("search-x",[["path",{d:"m13.5 8.5-5 5",key:"1cs55j"}],["path",{d:"m8.5 8.5 5 5",key:"a8mexj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);var i=a.i(88041),j=a.i(62115);async function k({searchParams:a}){let k=await a,l=Math.max(1,Number(k.page)||1),m="string"==typeof k.sort?k.sort:"default",n="string"==typeof k.flower?k.flower.split(","):[],o="string"==typeof k.occasion?k.occasion.split(","):[],p="string"==typeof k.color?k.color.split(","):[],q=await (0,i.getDb)(),r=await (0,j.getProducts)(q,{flower:n[0]||void 0,occasion:o[0]||void 0,color:p[0]||void 0,inStock:"in-stock"===k.availability||void 0,sort:{lth:"price-asc",htl:"price-desc",new:"newest",default:"newest"}[m]||"newest",page:l,limit:10}),s=r.total,t=(l-1)*10,u=r.products;return(0,b.jsx)("main",{children:(0,b.jsxs)("div",{className:"container mx-auto",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("header",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8",children:[(0,b.jsx)("div",{children:(0,b.jsxs)("p",{className:"font-poppins text-light-black/50",children:["Showing ",s>0?t+1:0," â€“"," ",Math.min(t+10,s)," of"," ",s," results"]})}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-gray-500",children:"Sort by:"}),(0,b.jsx)(e.default,{})]})]}),(0,b.jsx)("div",{className:"mb-8",children:(0,b.jsx)(c.default,{hideKeys:["sort","page","min","max"]})})]}),(0,b.jsx)("div",{children:0===u.length?(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 text-center animate-in fade-in duration-500",children:[(0,b.jsx)("div",{className:"bg-rose-50 p-8 rounded-full mb-6",children:(0,b.jsx)(h,{className:"w-16 h-16 text-rose-300",strokeWidth:1})}),(0,b.jsx)("h2",{className:"text-3xl font-serif text-gray-800 mb-3",children:"No Blooms Found"}),(0,b.jsx)("p",{className:"text-gray-500 max-w-sm font-poppins leading-relaxed",children:"We couldn't find any matches for your current filters. Try broadening your search or resetting the price range."})]}):(0,b.jsx)("div",{className:"grid grid-cols-2 xl:grid-cols-3 gap-x-3.5 xl:gap-x-6 gap-y-10",children:u.map(a=>(0,b.jsx)(d.default,{isHaveFavIcon:!1,src:a.productImage||"/home/flower1.avif",name:a.name,price:g(a.price),currency:"Rs.",installment:`${g(Math.ceil(a.price/3))} x 3`},a.id))})}),s>10&&(0,b.jsx)("div",{children:(0,b.jsx)("footer",{className:"flex justify-center mt-14",children:(0,b.jsx)(f.default,{totalItems:s,itemsPerPage:10})})})]})})}a.s(["default",()=>k],92778)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__1616778d._.js.map